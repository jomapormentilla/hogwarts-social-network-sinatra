<hr />
<div class="row">
    <div class="col-md-9">
        <div class="card bg-light">
            <div class="card-header">
                <% if is_current_session? @post.wizard %>
                        <a href="/posts/<%= @post.id %>/edit" class="btn btn-outline-warning btn-sm float-right">Edit</a>
                <% end %>
                <h2><%= @post.title %></h2>
            </div>
            <div class="card-body">
                <p class="card-text"><%= @post.content %></p>
                
                <p><a href="/wizards/<%= @post.wizard.slug %>"><%= @post.wizard.username %></a><br />
                   <span style="color: #777;"><%= parse_timestamp @post.timestamp %></span></p>
                
                   <form action="/posts/<%= current_wizard.id %>/upvote" method="POST">
                        <input type="hidden" name="post[id]" value="<%= @post.id %>" />
                        <button type="submit" class="btn btn-outline-info btn-sm" <%= 'disabled' if @post.upvotes.any?{|up| up.wizard == current_wizard} %>><%= @post.upvotes.size %> Upvote<%= 's' if @post.upvotes.size != 1 %></button> &nbsp; 
                        <button type="button" class="btn btn-outline-primary btn-sm" disabled><%= @post.comments.size %> Comment<%= 's' if @post.comments.size != 1 %></button>
                    </form>
                <hr />

                <form action="" method="POST">
                    <textarea name="" placeholder="<%= current_wizard.username.upcase %> says..." class="form-control" /></textarea><br />
                    <button type="submit" name="" class="btn btn-primary" />Add Comment</button>
                </form>

                <hr />
                <% @post.comments.each do |comment| %>
                    <div class="media">
                        <img src="/images/hogwarts-logo-300x300.png" style="width: 64px;" alt="profile" class="align-self-start mr-3">
                        <div class="media-body">
                            <h5 class="mt-0"><a href="/wizards/<%= comment.wizard.slug %>"><%= comment.wizard.username %></a> said:</h5>
                            <p><%= comment.content %></p>
                        </div>
                    </div>
                    <hr />
                    <br />
                <% end %>
            </div>
        </div>
    </div>
    
    <div class="col-md-3">
        <div class="card bg-light">
            <h4 class="card-header text-center">About the Author</h4>
            <img src="/images/hogwarts-logo-v2.png" alt="profile" class="card-img-top" />
            <div class="card-body">
                <table class="table table-sm">
                    <tr>
                        <td style="text-align: right; padding-right: 5px;">Username:</td>
                        <td><%= @post.wizard.username.upcase %></td>
                    <tr>
                    <tr>
                        <td style="text-align: right; padding-right: 5px;">Name:</td>
                        <td><%= @post.wizard.name %></td>
                    <tr>
                    <tr>
                        <td style="text-align: right; padding-right: 5px;">House:</td>
                        <td><%= @post.wizard.house.name %></td>
                    <tr>
                </table>
                <% if !current_wizard.friends.include?(@post.wizard) %>
                    <form action="/wizards/<%= @post.wizard.slug %>/add_friend" method="POST">
                        <input type="hidden" name="friend_id" value="<%= @post.wizard.slug %>" />
                        <button type="submit" class="btn btn-block btn-outline-primary btn-sm">Add as Friend</button>
                    </form><br />
                <% end %>
                <a href="/wizards/<%= @post.wizard.slug %>" class="btn btn-block btn-outline-info btn-sm">View Profile</a>
            </div>
        </div>
    </div>
</div>